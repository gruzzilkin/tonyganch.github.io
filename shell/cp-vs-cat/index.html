<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><title>Tony Ganch</title><meta name="viewport" content="width=device-width, initial-scale=1.0"><link rel="stylesheet" href="/syntax.css"><link rel="stylesheet" href="/main.css"><link rel="shortcut icon" href="http://github.com/favicon.ico"></head><body><div class="content"><article class="post"><h2>Отличие cp и cat</h2><p>Скопировать файлы из консоли можно двумя способами: <code>cp a b</code> и <code>cat a &gt; b</code>.<br>Разницу между ними можно отчасти понять из сути самих команд: <code>cp</code> копирует
файл, а <code>cat</code> создаёт новый файл с таким же содержимым.<br>В большинстве случаев эти два метода взаимозаменяемы, но существует пара
нюансов.</p>
<h3 id="Права"><a href="#Права" class="headerlink" title="Права"></a>Права</h3><p class="note">
<b>TL;DR:</b> <code>cp</code> сохраняет оригинальные права на файл,
<code>cat</code> — нет.
</p>

<p>Создадим тестовый скрипт:</p>
<pre><code>$ touch a.sh
</code></pre><p>По умолчанию для новых файлов мы получаем права только на чтение и запись:</p>
<pre><code>$ ls -l a.sh
-rw-r--r--  1 tonyganch  foo  0 Oct  7 09:29 a.sh
</code></pre><p>Добавим право на исполнение:</p>
<pre><code>$ chmod +x a.sh
$ ls -l a.sh
-rwxr-xr-x  1 tonyganch  foo  0 Oct  7 09:29 a.sh
</code></pre><p>А теперь сделаем две копии этого скрипта и проверим их права:</p>
<pre><code>$ cp a.sh b.sh
$ ls -l b.sh
-rwxr-xr-x  1 tonyganch  foo  0 Oct  7 09:30 b.sh

$ cat a.sh &gt; c.sh
$ ls -l c.sh
-rw-r--r--  1 tonyganch  foo  0 Oct  7 09:30 c.sh
</code></pre><p>Как видим, <code>cp</code> скопировал скрипт вместе с правами оригинального файла, <code>cat</code> же
сохранил только содержимое файла.</p>
<h3 id="Разрежённые-файлы"><a href="#Разрежённые-файлы" class="headerlink" title="Разрежённые файлы"></a>Разрежённые файлы</h3><p class="note">
Пользователи Mac OS могут дальше не читать.
</p>

<p>В некоторых файловых системах существует понятие разрежённых файлов (<a href="http://en.wikipedia.org/wiki/Sparse_file" target="_blank" rel="external">sparse
files</a>).<br>Это такие чудесные файлы, в которых последовательность нулевых битов заменяется
на информацию об этой последовательности.<br>Иными словами, пустое пространство файла не занимает физического места на
диске.</p>
<figure>
    <img src="http://upload.wikimedia.org/wikipedia/commons/9/9f/Sparse_file_%28en%29.svg">
</figure>

<p>В терминале это можно сделать так:</p>
<pre><code>$ dd if=/dev/null of=a.sh bs=512b seek=5
</code></pre><p>Нас интересует размер получившегося файла, поэтому взвешиваем его:</p>
<pre><code>$ du -sh a.sh
0       a.sh
</code></pre><p>Теперь копируем скрипт и взвешиваем результат:</p>
<pre><code>$ cp a.sh b.sh
$ du -sh b.sh
0       a.sh

$ cat a.sh &gt; c.sh
$ du -sh c.sh
1,3M    c.sh
</code></pre><p><code>cp</code> просто делает копию, не трогая содержимое, а <code>cat</code> «распаковывает» наш
ужатый файл.</p>
</article><footer class="footer"><p>Feel free to drop me a line <a href="mailto:tonyganch+tg.com@gmail.com" title="by mail">by mail</a> or <a href="https://twitter.com/tonyganch" title="via twitter" target="_blank" rel="external">via twitter</a>.</p><p>Other notes:</p><ul><li><a href="/csscomb/csscomb-core/">CSScomb Core: postprocessor in 15 mins</a></li><li><a href="/git/reset/">git reset: повернуть время вспять</a></li><li><a href="/edu/courses-fall-13/">Обзор курсов для биоинформатиков</a></li><li><a href="/git/rebase/">git rebase: порядок в локальных ветках</a></li></ul></footer></div><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-41864668-1', 'tonyganch.com');
ga('send', 'pageview');</script><script>(function (d, w, c) {
  (w[c] = w[c] || []).push(function() {
    try {
      w.yaCounter21565555 = new Ya.Metrika({id:21565555,
              clickmap:true,
              trackLinks:true,
              accurateTrackBounce:true});
    } catch(e) { }
  });
  var n = d.getElementsByTagName("script")[0],
    s = d.createElement("script"),
    f = function () { n.parentNode.insertBefore(s, n); };
  s.type = "text/javascript";
  s.async = true;
  s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js";
  if (w.opera == "[object Opera]") {
    d.addEventListener("DOMContentLoaded", f, false);
  } else { f(); }
})(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="//mc.yandex.ru/watch/21565555" style="position:absolute; left:-9999px;" alt=""></div></noscript></body></html>